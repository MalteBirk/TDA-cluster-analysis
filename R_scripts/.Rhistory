figure_name = strsplit(name, split = "_")
figure_name <- sapply(figure_name, function(x) x[1:2])
figure_name = figure_name[1]
tsv_file = paste("../python_scripts/",figure_name,".tsv", sep = "")
tipcategories = read.csv(tsv_file,
sep = "\t",
col.names = c("species", "genus_name", "operon"),
header = FALSE,
stringsAsFactors = FALSE)
dd = as.data.frame(tipcategories)
tree <- read.tree(paste("../python_scripts/",name, sep = ""))
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0)# size of label border
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
}
View(tipcategories)
View(combined_plot)
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) # size of label border
combined_plot <- gheatmap(combined_plot,
data.frame(factor(operon)),
offset=0.02,
width=0.02,
low="darkorange1",
high="blue",
colnames = FALSE,
font.size=2,
color="black")
combined_plot <- gheatmap(combined_plot.(factor(operon)),
offset=0.02,
width=0.02,
low="darkorange1",
high="blue",
colnames = FALSE,
font.size=2,
color="black")
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape = operon))
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape= operon), offset=2, align=T, size=.16, hjust=0)
combined_plot
figure_name = strsplit(name, split = "_")
figure_name <- sapply(figure_name, function(x) x[1:2])
figure_name = figure_name[1]
tsv_file = paste("../python_scripts/",figure_name,".tsv", sep = "")
tipcategories = read.csv(tsv_file,
sep = "\t",
col.names = c("species", "genus_name", "operon"),
header = FALSE,
stringsAsFactors = FALSE)
dd = as.data.frame(tipcategories)
tree <- read.tree(paste("../python_scripts/",name, sep = ""))
plotted_tree = ggtree(tree, aes(color = group)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(operon)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape= operon), offset=2, align=T, size=.16, hjust=0)
combined_plot
plotted_tree = ggtree(tree, aes(color = genus_name)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(operon)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape= operon), offset=2, align=T, size=.16, hjust=0)
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(operon)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape= operon), offset=0.4, align=T, size=.16, hjust=0)
combined_plot
plotted_tree = ggtree(tree, aes(color = operon)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape= operon), offset=0.4, align=T, size=.16, hjust=0)
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
plotted_tree = ggtree(tree, aes(color = operon)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) # size of label border
#geom_tiplab(aes(shape= operon), offset=0.4, size=.16, hjust=0)
combined_plot
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) # size of label border
geom_tiplab(aes(shape= operon), offset=0.4, hjust=0)
combined_plot
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) # size of label border
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) # size of label border
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape = operon), offset=0.4, hjust=0)
combined_plot
plotted_tree = ggtree(tree, aes(colour = operon)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tiplab(aes(shape = operon), offset=0.4, hjust=0)
combined_plot
plotted_tree = ggtree(tree, aes(colour = operon)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), offset=0.4, hjust=0)
combined_plot
plotted_tree = ggtree(tree, aes(colour = operon)) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon))
combined_plot
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon))
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, colour = genus_name), alpha = 0.25)
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), alpha = 0.25)
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), position = 1)
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), position = "right")
geom_tippoint
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 1)
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.5)
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.5, offset(1))
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.5, offset(1))
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.5, offset = 1)
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.5, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.1, position = "identity")
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon), size = 0.3, position = "identity")
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot)
geom_tippoint
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = factor(operon)), size = 0.3, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = factor(operon), fill = factor(operon)), size = 0.3, position = "identity")
combined_plot
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = "grey"), size = 0.3, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = symbol(operon)), size = 0.3, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon, size = 0.3, position = "identity")
combined_plot
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
}
all_tree_files = list.files("../python_scripts", pattern = "_tree.tree")
all_tree_files_list = as.list(strsplit(all_tree_files, '\\s+'))
result_path <- readLines(paste("../python_scripts", "/R_information_file", sep = ""))
for (name in all_tree_files_list)
{
figure_name = strsplit(name, split = "_")
figure_name <- sapply(figure_name, function(x) x[1:2])
figure_name = figure_name[1]
tsv_file = paste("../python_scripts/",figure_name,".tsv", sep = "")
tree <- read.tree(paste("../python_scripts/",name, sep = ""))
plotted_tree = ggtree(tree) + geom_treescale() + geom_tiplab(size = 0.8)
ggsave(file=paste(result_path,figure_name,"_no_colours_identity_tree_Rfig",".png",sep = ""), plotted_tree, limitsize = FALSE)
}
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity")
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity") +
theme(legend.key.size = unit(3,"line"))
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity") +
theme(legend.key.size = unit(1,"line"))
combined_plot
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity") +
guides(shape = guide_legend(override.aes = list(size = 5)))
combined_plot
library("tidyverse")
library("ggtree")
setwd(getwd())
# Saves all data frames and information about where to write PNG's
paste(getwd())
all_tree_files = list.files("../python_scripts", pattern = "_tree.wrangled")
all_tree_files_list = as.list(strsplit(all_tree_files, '\\s+'))
result_path <- readLines(paste("../python_scripts", "/R_information_file", sep = ""))
for (name in all_tree_files_list)
{
figure_name = strsplit(name, split = "_")
figure_name <- sapply(figure_name, function(x) x[1:2])
figure_name = figure_name[1]
tsv_file = paste("../python_scripts/",figure_name,".tsv", sep = "")
tipcategories = read.csv(tsv_file,
sep = "\t",
col.names = c("species", "genus_name", "operon"),
header = FALSE,
stringsAsFactors = FALSE)
dd = as.data.frame(tipcategories)
tree <- read.tree(paste("../python_scripts/",name, sep = ""))
plotted_tree = ggtree(tree) + geom_treescale()
combined_plot = plotted_tree %<+% dd +
geom_tiplab(aes(fill = factor(genus_name)),
size = 0.8,
linesize = 0.005,
color = "black", # color for label font
geom = "label",  # labels not text
label.padding = unit(0.0001, "lines"), # amount of padding around the labels
label.size = 0) + # size of label border
geom_tippoint(aes(shape = operon, color = operon), size = 0.3, position = "identity") +
guides(shape = guide_legend(override.aes = list(size = 5)))
ggsave(file=paste(result_path,figure_name,"_identity_tree_Rfig",".png",sep = ""), combined_plot, limitsize = FALSE)
}
figure_name = strsplit(name, split = "_")
